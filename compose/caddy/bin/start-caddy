#!/bin/bash

set -eou pipefail

: ${APP_ENV?"APP_ENV not set. Aborting !"}

if [ "$APP_ENV" = "prod" ]; then
    exec /usr/bin/caddy --conf /etc/Caddyfile --log stdout
else
    # For staging etc. run the following, as it's not rate limited
    exec /usr/bin/caddy -ca https://acme-staging.api.letsencrypt.org/directory --conf /etc/Caddyfile --log stdout
fi
